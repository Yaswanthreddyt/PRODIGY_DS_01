import pandas as pd
import matplotlib.pyplot as plt

csv_file_path = '/API_SP.POP.TOTL_DS2_en_csv_v2_45183.csv'
data = pd.read_csv(csv_file_path, skiprows=4)

# Display the first few rows of the dataframe to understand its structure
print(data.head())

# Plotting the total population for the year 2020
year = '2020'
other_year = '2010'  # Choose another year for dual-axis

# Drop rows with missing values for the specified years
data_years = data[['Country Name', year, other_year]].dropna()

# Sort the data by population for better visualization
data_years = data_years.sort_values(by=year, ascending=False)

# Create a dual-axis bar chart
fig, ax1 = plt.subplots(figsize=(14, 8))

# Plot the first set of data
color = 'tab:blue'
ax1.set_xlabel('Country')
ax1.set_ylabel(f'Population in {year}', color=color)
ax1.bar(data_years['Country Name'][:20], data_years[year][:20], color=color, alpha=0.6, label=year)
ax1.tick_params(axis='y', labelcolor=color)
ax1.set_xticklabels(data_years['Country Name'][:20], rotation=90)

# Creates a second y-axis to plot the other set of data
ax2 = ax1.twinx()
color = 'tab:red'
ax2.set_ylabel(f'Population in {other_year}', color=color)
ax2.plot(data_years['Country Name'][:20], data_years[other_year][:20], color=color, label=other_year, marker='o')
ax2.tick_params(axis='y', labelcolor=color)

# Title and show plot for data
fig.tight_layout()
plt.title(f'Top 20 Most Populous Countries in {year} and {other_year}')
plt.show()
